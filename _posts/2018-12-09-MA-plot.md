---
title: "MA plot to visualize gene expression data using Python"
date:   2018-12-09 010:19:20
author_profile: true
permalink: blog/ma.html
classes: wide
---

<p>
{% include  share.html %}
</p>

**<span style="color:#33a8ff">What is MA plot?</span>**
 - 2-dimensional (2D) scatter plot to visualize gene expression datasets
 - Visualize and identify  gene expression changes from two different conditions (eg. normal vs. 
   treated) in terms of log fold change (M) on Y-axis and log of mean of expression counts of normal and treated 
   samples (A) on X-axis
 - Genes with similar expression values in both normal and treated samples will cluster around M=0 value i.e genes 
   expressed with no significant differences in between treatments
 - Points away from M=0 line indicates genes with significant expression, For example, gene is upregulated and 
   downregulated if point is above and below M=0 line respectively
 - MA plot does not consider statistical measures (P-values or adjusted P-values) and therefore we can not tell genes 
   with statistically significant differences between normal vs. treated from MA plot (Use 
   <a href="https://reneshbedre.github.io/blog/volcano.html" target="_blank">Volcano plot</a> if you want indicates 
   genes with statistically significant differences)
   
**<span style="color:#33a8ff">How to create MA plot in Python?</span>**

For generating MA plot, I have used gene expression data published in Bedre et al. 2016 to identify significantly
induced or downregulated genes in response to salt stress in <i>Spartina alterniflora</i> 
(<a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-016-3017-3">Read paper</a>). 
Here's you can download gene expression dataset used for generating MA plot: 
[dataset]({{"/assets/posts/ma/test_dataset.csv" | absolute_url }})

```python
# We will use `bioinfokit` for volcano plot.
# download and install bioinfokit (Tested on Linux, Mac, Windows) 
git clone https://github.com/reneshbedre/bioinfokit.git
cd bioinfokit
python3 setup.py install
```

After installing `bioinfokit`, it can be used for MA plot,

```python
# you can use interactive python console, jupyter or python code
# I am using interactive python console (Python 3.6)
>>> from bioinfokit import visuz
# here you can change default parameters. 
# Read documentation at https://github.com/reneshbedre/bioinfokit
>>> visuz.ma(table="test_dataset.csv", lfc="log2FC", ct_count="value1", st_count="value2")
# plot will be saved in same directory (ma.png)
```

Generated MA plot by adding above code (green: upregulated and red: downregulated genes),

![screenshot]({{ "/assets/posts/ma/ma.png" | absolute_url }})



<p>
{% include  cite.html %}
</p>

<p>
{% include  share.html %}
</p>
    
<span style="color:#9e9696"><i> Last updated: March 15, 2019</i> </span>   
