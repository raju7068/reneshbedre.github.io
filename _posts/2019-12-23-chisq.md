---
title: "Chi-square test in Python"
date:   2019-12-23 02:15:18
description: "Advanced Bioinformatics"
permalink: blog/chisq.html
author_profile: true
classes: wide
toc: true
toc_label: "Page Content"
---
<p>
{% include  share.html %}
</p>

## <span style="color:#33a8ff"> What is a Chi-square (Ï‡2) test for independence (Pearson Chi-square test)?</span>
 - Chi-square test is a non-parametric (distribution-free) method used to compare the relationship between the two 
   categorical (nominal) variables in a contingency table
 - For example, we have different treatments (treated and nontreated) and treatment outcomes (cured and noncured), here
   we could use the chi-square test for independence to check whether treatments are related to treatment outcomes.
 - Note: Chi-square test for independence is different than the chi-square goodness-of-fit test
 
## <span style="color:#33a8ff">Hypotheses</span>
 - <i>Null hypotheses</i>: The two categorical variables are independent (no association between the two variables)
 - <i>Alternative hypotheses</i>: The two categorical variables are dependent (there is an association between the two variables)
- Note: There are no one or two-tailed P-value. Rejection region of the chi-square test is always on the right side of 
  the distribution.
 
## <span style="color:#33a8ff">Assumptions</span>
- The two variables are categorical (nominal) and data is randomly sampled
- The levels of variables are mutually exclusive 
- The expected frequency count for at least 80% of the cell in a contingency table is at least 5
- The expected frequency count should not be less than 1
- Observations should be independent of each other
- Observation data should be frequency counts and not percentages or transformed data

## <span style="color:#33a8ff">How to perform a chi-square test for independence using Python?</span>
- We will use `bioinfokit` 
- Check [bioinfokit documentation]({{"/blog/howtoinstall.html" | absolute_url }}) for installation and documentation
- Download a hypothetical <a href="/assets/posts/chisq/drugdata.csv">dataset</a> for chi-square test for independence

```python
# you can use interactive python interpreter, jupyter notebook, spyder or python code
# I am using interactive python interpreter (Python 3.7)
>>> from bioinfokit import analys
>>> import pandas as pd
# Read documentation at https://github.com/reneshbedre/bioinfokit
>>> df = pd.read_csv("https://reneshbedre.github.io/assets/posts/chisq/drugdata.csv", index_col=0) 
>>> df.head()
            cured  noncured
treatments
treated        60        10
nontreated     30        25
# run chi-square test
>>> analys.stat.chisq(df=df)

# output


Chi-squared test

Test              Df    Chi-square      P-value
--------------  ----  ------------  -----------
Pearson            1       13.3365  0.000260291
Log-likelihood     1       13.4687  0.000242574

Expected frequency counts

      cured    noncured
--  -------  ----------
 0     50.4        19.6
 1     39.6        15.4

``` 

Generated mosaic plot,

<p align="center">
<img src="/assets/posts/chisq/mosaic.png" width="500">
</p>

### Interpretation
The P-value obtained from chi-square test for independence is significant (P<0.05), and therefore, we conclude 
that there is a significant association between treatments (treated and nontreated) with treatment outcome 
(cured and noncured)

### References
- Virtanen P, Gommers R, Oliphant TE, Haberland M, Reddy T, Cournapeau D, Burovski E, Peterson P, Weckesser W, Bright J, van der Walt SJ.
  SciPy 1.0: fundamental algorithms for scientific computing in Python. Nature methods. 2020 Mar;17(3):261-72.

<p>
{% include  cite.html %}
</p>

<p>
{% include  share.html %}
</p>
    
<span style="color:#9e9696"><i> Last updated: March 29, 2020</i> </span>    

<p>
{% include  license.html %}
</p>