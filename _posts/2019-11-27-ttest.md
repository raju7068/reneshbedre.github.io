---
title: "Two sample and Welch's t-test in Python"
date:   2019-12-15 06:18:08
permalink: blog/ttest.html
author_profile: false
classes: wide
---

<p>
{% include  share.html %}
</p>

## <span style="color:#33a8ff">What is Two sample t-test (unpaired or independent t-test)?</span>
 - Used to compare the means of two independent groups 
 - For example, we have two different plant genotypes (genotype A and genotype B) and would like to compare if the yield
   of genotype A is significantly different from genotype B

## <span style="color:#33a8ff">Two sample t-test Hypotheses</span>
 - <i>Null hypotheses</i>: Two group means are equal  
 - <i>Alternative hypotheses</i>: Two group means are different (two-tailed)
 - <i>Alternative hypotheses</i>: Mean of one group either greater or lesser than another group (one-tailed)
 
## <span style="color:#33a8ff">Two sample t-test Assumptions</span>
 - Two groups have a normal distribution
 - Homogeneity of variances (variances are equal between treatment groups) 
 - Observations in two groups are sampled independently from each other

## <span style="color:#33a8ff">How to perform Two sample t-test in Python?</span>
- We will use `bioinfokit v0.7` or later
- Check [bioinfokit documentation]({{"/blog/howtoinstall.html" | absolute_url }}) for installation and documentation
- Download <a href="/assets/posts/ttest/genotype.csv">dataset</a> for two sample and Welch's t-test

```python
# you can use interactive python interpreter, jupyter notebook, spyder or python code
# I am using interactive python interpreter (Python 3.7)
>>> from bioinfokit.analys import get_data, stat
# load dataset as pandas dataframe
# the dataset should not have missing (NaN) values. If it has, it will omitted
>>> df = get_data('ttest').data
>>> df.head()
  Genotype  yield
0        A   78.0
1        A   84.3
2        A   81.0
3        B   88.0
4        B   92.0

>>> stat.ttsam(df=df, xfac="Genotype", res="yield")

# output

Two sample ['A' 'B'] t-test with equal variance

------------------  -------------
Mean diff           -10.3
t                    -5.40709
Std Error             1.90491
df                   10
P-value (one-tail)    0.000149204
P-value (two-tail)    0.000298408
Lower 95.0%         -14.5444
Upper 95.0%          -6.05561
------------------  -------------

Parameter estimates

Level      Number    Mean    Std Dev    Std Error    Lower 95.0%    Upper 95.0%
-------  --------  ------  ---------  -----------  -------------  -------------
A               6    79.1    3.30817      1.35056        75.6283        82.5717
B               6    89.4    3.29059      1.34338        85.9467        92.8533

```

The generated boxplot for groups (genotype A and B)
<p align="center">
<img src="/assets/posts/ttest/ttsam_boxplot.png" width="500">
</p>

### Interpretation
 The P-value obtained from the t-test is significant (P<0.05), and therefore, we conclude that the yield of genotype A is 
 significantly different than genotype B.

### Two-sample t-test with unequal variance (Welch's t-test)
```python

>>> stat.ttsam(df=df, xfac="Genotype", res="yield", evar=False)

# output

Two sample ['A' 'B'] t-test with unequal variance

------------------  -------------
Mean diff           -10.3
t                    -5.40709
Std Error             1.90491
df                    9.99972
P-value (one-tail)    0.000149219
P-value (two-tail)    0.000298437
Lower 95.0%         -14.5444
Upper 95.0%          -6.05559
------------------  -------------

Parameter estimates

Level      Number    Mean    Std Dev    Std Error    Lower 95.0%    Upper 95.0%
-------  --------  ------  ---------  -----------  -------------  -------------
A               6    79.1    3.30817      1.35056        75.6283        82.5717
B               6    89.4    3.29059      1.34338        85.9467        92.8533

```

Check detailed <a href='https://reneshbedre.github.io/blog/howtoinstall.html#two-sample-t-test-with-equal-and-unequal-variance' target='_blank'>usage</a>


<p>
{% include  cite.html %}
</p>

<p>
{% include  share.html %}
</p>
    
<span style="color:#9e9696"><i> Last updated: April 16, 2020</i> </span>

