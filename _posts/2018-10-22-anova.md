---
layout: post
title: "ANOVA using Python"
date:   2018-10-22 06:18:08
author: Renesh Bedre
description: "Advanced Bioinformatics"
permalink: blog/anova.html
comments: true
hidden: true
---

**<span style="color:#33a8ff">What is ANOVA (ANalysis Of VAriance)?</span>**
 - used to compare the means of more than 2 groups (t-test can be used to compare 2 groups)
 - groups mean differences inferred by analyzing variances
 - Main types: One-way (one factor) and two-way (two factors) ANOVA (factor is an independent variable)
 
**<span style="color:#33a8ff">ANOVA Hypotheses</span>**
 - <i>Null hypotheses</i>: Groups means are equal (no variation in means of groups)
 - <i>Alternative hypotheses</i>: At least, one group mean is different from other groups
 
**<span style="color:#33a8ff">ANOVA Assumptions</span>** 
 - Residuals are normally distributed (Shapiro Wilks Test)
 - Homogeneity of variances (variances are equal between treatment groups) (Bartlett Test)
 - Observations are sampled independently from each other
 
**<span style="color:#33a8ff">How ANOVA works?</span>** 
 - Check sample sizes: equal number of observation in each group
 - Calculate Mean Square Error (MSE): mean of the group variances
 - Calculate Mean Square Between (MSB) 
 
**<span style="color:#33a8ff">One-way (one factor) ANOVA</span>**  

Example data for one-way ANOVA analysis, [dataset]({{"/myfiles/anova/onewayanova.txt" | absolute_url }})

| A  | B  | C  | D  |
|----|----|----|----|
| 25 | 45 | 30 | 54 |
| 30 | 55 | 29 | 60 |
| 28 | 29 | 33 | 51 |
| 36 | 56 | 37 | 62 |
| 29 | 40 | 27 | 73 |

Here, there are four treatments (A, B, C, and D), which are groups for ANOVA analysis. Treatments are independent 
variable and termed as factor. As there are four types of treatments, treatment factor has four levels. 


Import data
```python
import pandas as pd
import matplotlib.pyplot as plt
import scipy.stats as stats

# load data file
d = pd.read_csv("onewayanova.txt", sep="\t")

# generate a boxplot to see the data distribution by treatments. Using boxplot, we can easily detect the differences 
# between different treatments
d.boxplot(column=['A', 'B', 'C', 'D'], grid=False)
```

![screenshot]({{ "/myfiles/anova/onewaynova_boxplot.png" | absolute_url }})

```python
# stats f_oneway functions takes the groups as input and returns F and P-value
fvalue, pvalue = stats.f_oneway(d['A'], d['B'], d['C'], d['D'])
print(fvalue, pvalue)
# 17.492810457516338 2.639241146210922e-05
```

<b>Interpretation</b>: The P-value obtained from ANOVA analysis is significant (P<0.05), and therefore, we conclude 
that there are significant differences among treatments.

From ANOVA analysis, we know that treatment differences are statistically significant, but ANOVA does not tell which 
treatments are significantly different from each other. To know the pairs of significant different treatments, we
will perform multiple pairwise comparison analysis using <b>Tukey HSD</b> test.

 <i> In progress </i>